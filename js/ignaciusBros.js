function VolumeControls(){var e=this;e.icon=new Sprite("sprites/volume/volumeFull.png"),preloadImages(["sprites/volume/volumeFull.png","sprites/volume/volumeNoMusic.png","sprites/volume/volumeMute.png"]),e.onClick=function(){changeVolume()},e.render=function(i){e.icon.render(i,{x:canvasObj.width-e.icon.img.width-15,y:canvasObj.height-e.icon.img.height-15})}}function changeVolume(){"full"==volume?(volume="noMusic",music.pause(),music.currentTime=0,volumeControls.icon=new Sprite("sprites/volume/volumeNoMusic.png")):"noMusic"==volume?(volume="mute",music.pause(),music.currentTime=0,volumeControls.icon=new Sprite("sprites/volume/volumeMute.png")):"mute"==volume&&(volume="full",music.play(),volumeControls.icon=new Sprite("sprites/volume/volumeFull.png"))}function onClick(e){canvasObj.focus();var i=getClickPosition(e);return e.preventDefault(),i.x<=canvasObj.width-10&&i.x>=canvasObj.width-42&&i.y<=canvasObj.height-10&&i.y>=canvasObj.height-42&&volumeControls.onClick(),!1}function getClickPosition(e){var i=canvasObj.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}function onKeyDown(e){if(e.preventDefault(),keyStates[e.keyCode]=!0,116==e.keyCode&&location.reload(),trucos&&(80==e.keyCode&&(player.position.x=9130,player.position.y=301),79==e.keyCode&&(player.position.x=6345,player.position.y=299)),!player.dead){if(82==e.keyCode){var i=new Particle;i.skin=new AnimatedSprite("sprites/particulas/explosion.png"),i.skin.frameSize.width=32,i.skin.frameSize.height=32,i.skin.loop=!1,i.position.x=player.position.x,i.position.y=player.position.y,i.speed.x=0,i.team="neutral",i.lifeTime=5,particles.push(i);var i=new Particle;if(i.skin=new AnimatedSprite("sprites/particulas/explosion.png"),i.skin.frameSize.width=32,i.skin.frameSize.height=32,i.skin.loop=!1,i.position.x=player.position.x+10,i.position.y=player.position.y-10,i.speed.x=0,i.team="neutral",i.lifeTime=5,particles.push(i),i=new Particle,i.skin=new AnimatedSprite("sprites/particulas/explosion.png"),i.skin.frameSize.width=32,i.skin.frameSize.height=32,i.skin.loop=!1,i.position.x=player.position.x-15,i.position.y=player.position.y-20,i.speed.x=0,i.team="neutral",i.lifeTime=5,particles.push(i),i=new Particle,i.skin=new AnimatedSprite("sprites/particulas/explosion.png"),i.skin.frameSize.width=32,i.skin.frameSize.height=32,i.skin.loop=!1,i.position.x=player.position.x+20,i.position.y=player.position.y-30,i.speed.x=0,i.team="neutral",i.lifeTime=5,particles.push(i),i=new Particle,i.skin=new AnimatedSprite("sprites/particulas/explosion.png"),i.skin.frameSize.width=32,i.skin.frameSize.height=32,i.skin.loop=!1,i.position.x=player.position.x,i.position.y=player.position.y-30,i.speed.x=0,i.team="neutral",i.lifeTime=5,particles.push(i),"mute"!=volume){var t=new Audio("sound/suicide.mp3");t.play()}player.die()}if((32==e.keyCode||87==e.keyCode)&&player.jump(deltaTime),37==e.keyCode){var n=player.movement;player.movement="left","right"==n&&(player.speed.x=0),player.attack(deltaTime)}if(39==e.keyCode){var n=player.movement;player.movement="right","left"==n&&(player.speed.x=0),player.attack(deltaTime)}}}function onKeyUp(e){e.preventDefault(),keyStates[e.keyCode]=!1}function preloadImages(e){for(var i=new Array,t=0;t<e.length;t++)i[t]=new Image,i[t].src=e[t]}function SQLBoss(){var e=this;e.active=!1,e.dead=!1,e.enrage=!1,e.attackInterval=null,e.skin=new AnimatedSprite("sprites/enemigos/sqlboss.png"),e.skin.frameSize.width=137,e.skin.frameSize.height=142,e.skin.loop=!1,e.position={x:10125,y:374},e.direction="up",e.speed=80,e.maxLife=30,e.activate=function(){e.active||(e.active=!0,e.skin=new AnimatedSprite("sprites/enemigos/sqlboss.png"),e.skin.frameSize.width=137,e.skin.frameSize.height=142,e.skin.loop=!1,e.enrage=!1,enemies=new Array,e.position={x:10125,y:374},e.direction="up",e.speed=80,e.life=e.maxLife,e.attacking=!1,clearInterval(e.attackInterval),e.attackInterval=setInterval(e.attack,Math.floor(2e3*Math.random())+1500),preloadImages(["sprites/enemigos/sqlboss.png","sprites/enemigos/sqlboss_enrage.png","sprites/enemigos/sqlboss_dead.png"]))},e.goEnrage=function(){if(e.speed=130,e.skin=new AnimatedSprite("sprites/enemigos/sqlboss_enrage.png"),e.skin.frameSize.width=137,e.skin.frameSize.height=142,e.skin.loop=!1,"mute"!=volume){var i=new Audio("sound/bossEnrage.mp3");i.play()}},e.die=function(){if(e.active=!1,e.dead=!0,e.enrage=!1,e.skin=new AnimatedSprite("sprites/enemigos/sqlboss_dead.png"),e.skin.frameSize.width=137,e.skin.frameSize.height=142,e.skin.loop=!1,enemies=new Array,gameEndTimer=new Date,clearInterval(e.attackInterval),"mute"!=volume){var i=new Audio("sound/bossDie.mp3");i.play()}},e.attack=function(){e.active&&!e.dead&&e.shoot(e.enrage?5:3,player.position.y)},e.shoot=function(i,t){if(0>=i)return e.attacking=!1,clearInterval(e.attackInterval),void(e.attackInterval=setInterval(e.attack,Math.floor(2e3*Math.random())+1500));e.attacking=!0;var n=new Particle;n.skin=new AnimatedSprite("sprites/particulas/pk.png"),n.skin.frameSize.width=32,n.skin.frameSize.height=32,n.skin.loop=!0,n.position.x=e.position.x,n.position.y=i%2==0?t:e.position.y,n.speed.x=-10,n.team="enemy",particles.push(n),setTimeout(function(){e.shoot(i-1,player.position.y)},e.enrage?75:250)},e.update=function(i){if(e.skin.update(i),!e.dead){if(player.position.x>terrain.size()-1025?e.active||(e.activate(),e.active=!0):(e.active=!1,e.enrage=!1),!e.active)return;"up"==e.direction?e.position.y-=e.speed*i:e.position.y+=e.speed*i}},e.emulate=function(i){if(e.dead)return void(e.position.y<374&&(e.position.y+=300*i,e.position.y>374&&(e.position.y=374)));if(e.active){e.position.y<=150?(e.direction="down",e.position.y=150):e.position.y>=374&&(e.direction="up",e.position.y=374);for(var t=0;t<particles.length;t++){var n=particles[t];if(n.alive&&"friend"==n.team&&n.position.x>=e.position.x-e.skin.img.width/2&&n.position.x<=e.position.x+e.skin.img.width/2&&n.position.y>=e.position.y-e.skin.img.height&&n.position.y<=e.position.y){n.alive=!1,e.life--;var a=new Particle;if(a.skin=new AnimatedSprite("sprites/particulas/explosion.png"),a.skin.frameSize.width=32,a.skin.frameSize.height=32,a.skin.loop=!1,a.position.x=n.position.x,a.position.y=n.position.y,a.speed.x=0,a.team="neutral",a.lifeTime=.1,particles.push(a),"mute"!=volume){var o=new Audio("sound/bossDamage"+Math.floor(4*Math.random())+".mp3");o.play()}if(0==enemies.length){var s=new Enemy;s.setType(Math.floor(4*Math.random())),s.position={x:9275,y:374},s.speed.x=125,enemies.push(s)}}}!e.enrage&&e.life/e.maxLife*100<=34?(e.enrage=!0,e.goEnrage()):e.life<=0&&e.die()}},e.render=function(i){e.dead||(i.fillStyle="rgb(255, 0, 0)",i.fillRect(e.position.x-e.skin.img.width/2,e.position.y-e.skin.img.height-10,e.skin.img.width,6),i.fillStyle="rgb(0, 255, 0)",i.fillRect(e.position.x-e.skin.img.width/2,e.position.y-e.skin.img.height-10,e.skin.img.width/e.maxLife*e.life,6)),e.skin.render(i,e.position)}}function Enemy(){var e=this;e.life=4,e.position={x:0,y:0},e.lastPosition={x:0,y:0},e.movement=parseInt(2*Math.random(),10)?"left":"right",e.speed={x:Math.floor(50*Math.random())+150,y:0},e.skin=null,e.move=function(i){"left"==e.movement?e.moveLeft(i):e.moveRight(i)},e.moveLeft=function(i){e.position.x-=e.speed.x*i},e.moveRight=function(i){e.position.x+=e.speed.x*i},e.setType=function(i){e.skin=new AnimatedSprite("sprites/enemigos/"+i+".png"),e.skin.loop=!1},e.update=function(i){e.skin.update(i),e.move(i)},e.render=function(i){e.skin.render(i,e.position),e.lastPosition.x=e.position.x,e.lastPosition.y=e.position.y},e.die=function(){if(e.life=0,"mute"!=volume){var i=new Audio("sound/enemyDie.mp3");i.play()}points+=100},e.emulate=function(i){var t=terrain.getCollisionData(e.position.x,e.position.y),n=terrain.getCollision(t,e.position.x,e.position.y-2);0!=n&&(e.position.x=e.lastPosition.x,e.movement="left"==e.movement?"right":"left");var a=terrain.getCollision(t,e.position.x,e.position.y+2);0==a&&(e.position.x=e.lastPosition.x,e.movement="left"==e.movement?"right":"left"),e.position.y>500&&e.die(),e.position.x<0&&e.die();for(var o=0;o<particles.length;o++){var s=particles[o];if(s.alive&&"friend"==s.team&&s.position.x>=e.position.x-32&&s.position.x<=e.position.x+32&&s.position.y>=e.position.y-64&&s.position.y<=e.position.y+15){s.alive=!1,e.life--;var r=new Particle;if(r.skin=new AnimatedSprite("sprites/particulas/explosion.png"),r.skin.frameSize.width=32,r.skin.frameSize.height=32,r.skin.loop=!1,r.position.x=s.position.x,r.position.y=s.position.y,r.speed.x=0,r.team="neutral",r.lifeTime=.1,particles.push(r),"mute"!=volume){var l=new Audio("sound/enemyDamage.mp3");l.play()}}}if(e.life>0&&player.position.x+28>=e.position.x-32&&player.position.x-28<=e.position.x+32&&player.position.y>=e.position.y-64&&player.position.y<=e.position.y+1)if(player.lastPosition.y<=e.position.y-64){if(e.life-=2,player.onAir=!1,player.position.y=e.position.y-60,player.jump(i,!1),points+=50,"mute"!=volume){var l=new Audio("sound/enemyDamage.mp3");l.play()}}else player.die()}}function restartGame(){enemies=new Array,particles=new Array;var e=new Enemy;e.setType(2),e.position={x:750,y:372},enemies.push(e),e=new Enemy,e.setType(0),e.position={x:981,y:300},enemies.push(e),e=new Enemy,e.setType(1),e.position={x:1893,y:372},enemies.push(e),e=new Enemy,e.setType(3),e.position={x:1262,y:372},enemies.push(e),e=new Enemy,e.setType(1),e.position={x:1893,y:372},enemies.push(e),e=new Enemy,e.setType(2),e.position={x:2704,y:372},enemies.push(e),e=new Enemy,e.setType(0),e.position={x:4e3,y:372},enemies.push(e),e=new Enemy,e.setType(3),e.position={x:3700,y:372},enemies.push(e),e=new Enemy,e.setType(1),e.position={x:4730,y:372},enemies.push(e),e=new Enemy,e.setType(2),e.position={x:4816,y:156},enemies.push(e),e=new Enemy,e.setType(1),e.position={x:5480,y:372},enemies.push(e),e=new Enemy,e.setType(0),e.position={x:6152,y:372},enemies.push(e),e=new Enemy,e.setType(3),e.position={x:6966,y:380},enemies.push(e),e=new Enemy,e.setType(0),e.position={x:8160,y:373},enemies.push(e);for(var i=0;4>i;i++)e=new Enemy,e.setType(i),e.position={x:8600+100*i,y:373},enemies.push(e);points=0,gameTimer=new Date,player.position.x=startPosition.x,player.position.y=startPosition.y,player.dead=!1,player.changeAnimation("idleRight"),player.movement="right",sqlBoss.dead=!1,sqlBoss.active=!1,sqlBoss.enrage=!1,clearInterval(sqlBoss.attackInterval)}function Particle(){var e=this;e.position={x:0,y:0},e.lastPosition={x:0,y:0},e.speed={x:0,y:0},e.team="neutral",e.alive=!0,e.lifeTime=2,e.currentTime=0,e.skin=null,e.update=function(i){e.currentTime+=i,e.skin.update(i),e.currentTime>=e.lifeTime?e.alive=!1:(e.position.x+=e.speed.x*i*60,e.position.y+=e.speed.y*i*60)},e.emulate=function(i){e.position.x<-e.skin.img.width?e.alive=!1:e.position.x>terrain.size()+e.skin.img.width&&(e.alive=!1);var t=terrain.getCollisionData(e.position.x,e.position.y-16),n=terrain.getCollision(t,e.position.x,e.position.y-16-e.speed.y*i*60-1);if(0!=n&&(e.alive=!1,"friend"==e.team&&"mute"!=volume)){var a=new Audio("sound/glassesBreak.mp3");a.play()}"enemy"==e.team&&e.position.x>=player.position.x-32&&e.position.x<=player.position.x+32&&e.position.y>=player.position.y-48&&e.position.y<=player.position.y+16&&(e.alive=!1,player.die())},e.render=function(i){e.alive&&e.skin.render(i,e.position),e.lastPosition.x=e.position.x,e.lastPosition.y=e.position.y}}function Player(){var e=this;e.position={x:0,y:0},e.lastPosition={x:0,y:0},e.movement="none",e.dead=!1,e.speed={x:0,y:0},e.onAir=!1,e.attacking=!1,e.attackingTime=null,e.animations={},e.currentAnimation,e.attack=function(){if(0==e.attacking){e.attacking=!0,e.attackingTime=new Date;var i=new Particle;if(i.skin=new AnimatedSprite("sprites/particulas/gafas.png"),i.skin.frameDuration=.1,i.skin.frameSize.width=32,i.skin.frameSize.height=32,i.skin.loop=!0,i.position.x=e.position.x,i.position.y=e.position.y-10,i.team="friend","left"==e.movement?(i.speed.x=-10,e.changeAnimation("attackLeft")):(i.speed.x=10,e.changeAnimation("attackRight")),particles.push(i),"mute"!=volume){var t=new Audio("sound/ignaciusAttack.mp3");t.play()}}},e.jump=function(i,t){if(t="undefined"!=typeof t?t:!0,!e.onAir&&!e.dead&&(e.speed.y=-15,e.changeAnimation("right"==e.movement?"jumpRight":"jumpLeft"),e.onAir=!0,"mute"!=volume&&t)){var n=new Audio("sound/ignaciusJump.mp3");n.volume=.5,n.play()}},e.moveRight=function(i){e.attacking||e.changeAnimation(e.onAir?"jumpRight":"walkRight"),e.speed.x+=10*i,e.speed.x>5&&(e.speed.x=5),e.position.x+=100*i,e.movement="right"},e.moveLeft=function(i){e.attacking||e.changeAnimation(e.onAir?"jumpLeft":"walkLeft"),e.speed.x-=10*i,e.speed.x<-5&&(e.speed.x=-5),e.position.x-=100*i,e.movement="left"},e.changeAnimation=function(i){e.currentAnimation!=e.animations[i]&&(e.currentAnimation=e.animations[i],e.currentAnimation.frameIndex=0)},e.update=function(i){e.currentAnimation.update(i),e.dead||(e.speed.y+=49*i,e.position.y+=e.speed.y*i*60,e.position.x+=e.speed.x*i*60,e.attacking&&(new Date-e.attackingTime)/1e3>.33&&(e.attacking=!1))},e.render=function(i){e.currentAnimation.render(i,e.position),e.lastPosition.x=e.position.x,e.lastPosition.y=e.position.y},e.die=function(){if(!e.dead)if(e.dead=!0,e.speed.x=0,e.speed.y=0,e.attacking=!1,e.onAir=!0,e.currentAnimation==e.animations.walkLeft?e.changeAnimation("idleLeft"):e.currentAnimation==e.animations.walkRight&&e.changeAnimation("idleRight"),e.position.y<512){if("mute"!=volume){var i=new Audio("sound/ignaciusDie.mp3");i.play()}setTimeout(function(){restartGame()},1750)}else restartGame()},e.emulate=function(i){if(!e.dead){var t=terrain.getCollisionData(e.position.x,e.position.y),n=terrain.getCollision(t,e.position.x,e.position.y-e.speed.y*i*60-1);"collision"==n?(e.position.x=e.lastPosition.x,e.speed.x=0):"die"==n&&e.die();for(var a=terrain.getCollision(t,e.position.x,e.position.y-50);0!=a;)"die"==a&&e.die(),e.position.y++,e.speed.y=0,e.onAir=!0,a=terrain.getCollision(t,e.position.x,e.position.y-50);for(a=terrain.getCollision(t,e.position.x,e.position.y);0!=a;)"die"==a&&e.die(),e.position.y--,e.speed.y=0,e.onAir=!1,a=terrain.getCollision(t,e.position.x,e.position.y);e.position.y>500&&e.die(),e.position.x<0&&e.die(),e.position.x>terrain.size()&&e.die()}}}function Sprite(e){var i=this;i.isLoaded=!1,i.img=new Image,i.img.onload=function(){i.isLoaded=!0},i.img.src=e,i.render=function(e,t){i.isLoaded&&e.drawImage(i.img,t.x,t.y)}}function AnimatedSprite(e){var i=this;i.frameSize={width:64,height:64},i.isLoaded=!1,i.img=new Image,i.img.onload=function(){i.isLoaded=!0},i.img.src=e,i.frameIndex=0,i.frameDuration=.25,i.frameTime=0,i.loop=!0,i.nextAnimation=null,i.update=function(e){for(i.frameTime+=e;i.frameTime>=i.frameDuration;)i.frameIndex++,i.frameIndex>Math.floor(i.img.width/i.frameSize.width,10)-1&&(1==i.loop?i.frameIndex=0:(null!=i.nextAnimation&&player.changeAnimation(i.nextAnimation),i.frameIndex=Math.floor(i.img.width/i.frameSize.width,10)-1)),i.frameTime-=i.frameDuration},i.render=function(e,t){i.isLoaded&&e.drawImage(i.img,i.frameSize.width*i.frameIndex,0,i.frameSize.width,i.frameSize.height,Math.round(t.x-i.frameSize.width/2),Math.round(t.y-i.frameSize.height),i.frameSize.width,i.frameSize.height)}}function getImageData(e){var i=document.createElement("canvas");i.width=e.width,i.height=e.height;var t=i.getContext("2d");return t.drawImage(e,0,0),t.getImageData(0,0,e.width,e.height)}function getPixel(e,i,t){var n=4*(Math.round(i)+e.width*Math.round(t)),a=e.data;return{r:a[n],g:a[n+1],b:a[n+2],a:a[n+3]}}function Terrain(e){var i=this;i.sections=new Array;for(var t=0;t<e.length;t++){var n=new Sprite(e[t].drawable),a=new Sprite(e[t].collision);i.sections.push({drawable:n,collision:a,collisionData:null})}i.addTerrain=function(e){var t=new Sprite(e.drawable),n=new Sprite(e.collision);i.sections.push({drawable:t,collision:n,collisionData:null})},i.size=function(){for(var e=0,t=0;t<i.sections.length;t++)e+=i.sections[t].drawable.img.width;return e},i.render=function(e){for(var t=0,n=0;n<i.sections.length;n++)e.drawImage(i.sections[n].drawable.img,t,0,i.sections[n].drawable.img.width,i.sections[n].drawable.img.height),t+=i.sections[n].drawable.img.width},i.getCollisionData=function(e){for(var t=0,n=0,a=0;a<i.sections.length&&(n=a,!(e>=t&&e<t+i.sections[a].collision.img.width));a++)t+=i.sections[a].collision.img.width;return i.sections[n].collision.isLoaded?(null==i.sections[n].collisionData&&(i.sections[n].collisionData=getImageData(i.sections[n].collision.img)),{index:n,data:i.sections[n].collisionData}):getImageData(i.sections[n].collision.img)},i.getCollision=function(e,i,t){var n=getPixel(e.data,i,t-e.index);return n.b>200?"collision":n.r>200?"die":!1}}function init(){canvasObj=document.getElementById("game"),canvasObj.width=canvasObj.clientWidth,canvasObj.height=canvasObj.clientHeight,canvasObj.setAttribute("tabindex","0"),canvasObj.focus(),canvasObj.addEventListener("mousedown",onClick,!1),canvasObj.addEventListener("keydown",onKeyDown,!1),canvasObj.addEventListener("keyup",onKeyUp,!1),ctx=canvasObj.getContext("2d"),ctx.imageSmoothingEnabled=ctx.webkitImageSmoothingEnabled=ctx.mozImageSmoothingEnabled=!1,player.position.x=startPosition.x,player.position.y=startPosition.y,player.animations.walkLeft=new AnimatedSprite("sprites/ignacius/walkLeft.png"),player.animations.walkLeft.frameDuration=.25,player.animations.walkRight=new AnimatedSprite("sprites/ignacius/walkRight.png"),player.animations.walkRight.frameDuration=.25,player.animations.idleLeft=new AnimatedSprite("sprites/ignacius/idleLeft.png"),player.animations.idleLeft.frameDuration=.5,player.animations.idleRight=new AnimatedSprite("sprites/ignacius/idleRight.png"),player.animations.idleRight.frameDuration=.5,player.animations.jumpLeft=new AnimatedSprite("sprites/ignacius/jumpLeft.png"),player.animations.jumpLeft.frameDuration=.1,player.animations.jumpLeft.loop=!1,player.animations.jumpRight=new AnimatedSprite("sprites/ignacius/jumpRight.png"),player.animations.jumpRight.frameDuration=.1,player.animations.jumpRight.loop=!1,player.animations.attackRight=new AnimatedSprite("sprites/ignacius/attackRight.png"),player.animations.attackRight.frameDuration=1,player.animations.attackRight.loop=!1,player.animations.attackRight.nextAnimation="idleRight",player.animations.attackLeft=new AnimatedSprite("sprites/ignacius/attackLeft.png"),player.animations.attackLeft.frameDuration=1,player.animations.attackLeft.loop=!1,player.animations.attackLeft.nextAnimation="idleLeft",player.changeAnimation("idleRight"),player.movement="right",preloadImages(["sprites/enemigos/0.png","sprites/enemigos/1.png","sprites/enemigos/2.png","sprites/enemigos/3.png","sprites/particulas/explosion.png","sprites/particulas/gafas.png","sprites/particulas/nube.png","sprites/particulas/pk.png"]),mainTimer=new Date;var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null;if(null!==e){var i=function(){processGame(),e(i,canvasObj)};e(i,canvasObj)}else clearInterval(mainInterval),mainInterval=setInterval(processGame,1e3/fps);restartGame()}function processGame(){deltaTime=(new Date-mainTimer)/1e3,mainTimer=new Date,player.update(deltaTime);for(var e=0;e<enemies.length;e++)enemies[e].update(deltaTime);sqlBoss.update(deltaTime);for(var e=0;e<particles.length;e++)particles[e].update(deltaTime);for(var e=0;e<clouds.length;e++)clouds[e].update(deltaTime);player.dead||(keyStates[65]?player.moveLeft(deltaTime):keyStates[68]?player.moveRight(deltaTime):player.onAir||("right"==player.movement?(player.speed.x>0&&(player.speed.x-=100*deltaTime),player.speed.x<0&&(player.speed.x=0),player.attacking||player.changeAnimation("idleRight")):(player.speed.x<0&&(player.speed.x+=100*deltaTime),player.speed.x>0&&(player.speed.x=0),player.attacking||player.changeAnimation("idleLeft")))),player.emulate(deltaTime),sqlBoss.emulate(deltaTime);for(var e=0;e<enemies.length;e++)enemies[e].emulate(deltaTime);for(var e=0;e<particles.length;e++)particles[e].emulate(deltaTime);for(var e=0;e<particles.length;e++)particles[e].alive||particles.splice(e,1);for(var e=0;e<enemies.length;e++)enemies[e].life<=0&&(enemies[e].die(),enemies.splice(e,1));renderGame()}function Camera(){}function renderGame(){var e=ctx.createLinearGradient(0,0,0,canvasObj.height);sqlBoss.enrage?e.addColorStop(0,"rgb(224, 53, 56)"):e.addColorStop(0,"rgb(117, 237, 250)"),e.addColorStop(1,"white"),ctx.fillStyle=e,ctx.fillRect(0,0,canvasObj.width,canvasObj.height),ctx.setTransform(1,0,0,1,0,0),ctx.fillRect(0,0,canvasObj.width,canvasObj.height),Camera.lookAt(ctx,player.position.x,0),player.position.x<canvasObj.width/2?(Camera.clear(),Camera.lookAt(ctx,canvasObj.width/2,0)):player.position.x>terrain.size()-1025&&(Camera.clear(),Camera.lookAt(ctx,terrain.size()-canvasObj.width/2,0)),ctx.globalAlpha=.75;for(var i=0;i<clouds.length;i++)clouds[i].render(ctx);ctx.globalAlpha=1,terrain.render(ctx),player.render(ctx);for(var i=0;i<enemies.length;i++)enemies[i].render(ctx);for(var i=0;i<particles.length;i++)particles[i].render(ctx);sqlBoss.render(ctx),Camera.clear(ctx),renderFps(ctx),renderScore(ctx),volumeControls.render(ctx),player.dead&&(ctx.textBaseline="center",ctx.textAlign="center",ctx.fillStyle="#FF0000",ctx.font="42pt Arial",ctx.fillText("NOOOB",canvasObj.width/2,canvasObj.height/4))}function renderScore(e){sqlBoss.dead?(e.textBaseline="top",e.textAlign="center",e.fillStyle="#000000",e.font="42px Arial",e.fillText("Puntos: "+points,canvasObj.width/2,canvasObj.height/2-75),e.textBaseline="center",e.textAlign="center",e.fillStyle="#000000",e.font="42px Arial",e.fillText("Tiempo: "+Math.round((gameEndTimer-gameTimer)/1e3)+"s",canvasObj.width/2,canvasObj.height/2-25),e.textBaseline="bottom",e.textAlign="center",e.fillStyle="#007700",e.font="42px Arial",e.fillText("WINRAAAR !!!",canvasObj.width/2,canvasObj.height/2+75)):(e.textBaseline="top",e.textAlign="left",e.fillStyle="#000000",e.font="24px Arial",e.fillText("Puntos: "+points,15,10),e.textBaseline="top",e.textAlign="right",e.fillStyle="#000000",e.font="32px Arial",e.fillText(Math.round((new Date-gameTimer)/1e3)+"s",canvasObj.width-15,10))}function renderFps(e){e.textBaseline="top",e.textAlign="center",e.fillStyle="#000000",e.font="12px Arial",e.fillText(Math.floor(1/deltaTime)+" fps",canvasObj.width/2,10)}function createCloudLoop(){var e=new Particle;e.skin=new AnimatedSprite("sprites/particulas/nube.png"),e.skin.frameSize={width:192,height:92},e.skin.loop=!1,e.team="neutral",e.lifeTime=999,e.position={x:terrain.size()+192,y:Math.floor(150*Math.random())+90},e.speed.x=-1.5*(Math.floor(5*Math.random())+6)/10,clouds.push(e),clearInterval(cloudInterval),cloudInterval=setInterval(function(){createCloudLoop()},Math.floor(4e3*Math.random())+4e3)}function createClouds(){clouds=new Array;for(var e=0;6144>e;e+=Math.floor(750*Math.random())+400){var i=new Particle;i.skin=new AnimatedSprite("sprites/particulas/nube.png"),i.skin.frameSize={width:192,height:92},i.skin.loop=!1,i.team="neutral",i.lifeTime=999,i.position={x:e,y:Math.floor(150*Math.random())+90},i.speed.x=-1.5*(Math.floor(5*Math.random())+6)/10,clouds.push(i)}setTimeout(function(){createCloudLoop()},4e3)}var trucos=!0,fps=60,mainInterval,mainTimer,deltaTime,points=0,gameTimer,gameEndTimer,canvasObj,ctx,music=new Audio("sound/music.mp3");music.addEventListener("ended",function(){this.currentTime=0,this.play()},!1),music.play();var volume="full",volumeControls=new VolumeControls,keyStates=new Array;window.addEventListener("load",init,!1);var sqlBoss=new SQLBoss,enemies=new Array,particles=[],clouds=[],startPosition={x:50,y:370},player=new Player,terrain=new Terrain([{drawable:"sprites/map/1_1.png",collision:"sprites/map/1_1A.png"},{drawable:"sprites/map/1_2.png",collision:"sprites/map/1_2A.png"},{drawable:"sprites/map/1_3.png",collision:"sprites/map/1_3A.png"},{drawable:"sprites/map/1_4.png",collision:"sprites/map/1_4A.png"},{drawable:"sprites/map/1_5.png",collision:"sprites/map/1_5A.png"}]);Camera.lookAt=function(e,i,t){e.translate(-i+canvasObj.width/2,t)},Camera.clear=function(){ctx.setTransform(1,0,0,1,0,0)};var cloudInterval;createClouds();